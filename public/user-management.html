<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Management - Menu</title>
    <link rel="stylesheet" href="styles-admin.css">
</head>
<body>
    <div class="admin-container">
        <!-- Navigation -->
        <nav class="admin-nav">
            <div class="nav-brand">
                <h1>üìä Menu</h1>
            </div>
            <div class="nav-menu">
                <a href="survey-results.html" class="nav-item">
                    üìã K·∫øt qu·∫£ kh·∫£o s√°t
                </a>
                <a href="data-upload.html" class="nav-item">
                    üì§ Qu·∫£n l√Ω d·ªØ li·ªáu
                </a>
                <a href="user-management.html" class="nav-item active">
                    üë• Qu·∫£n l√Ω ng∆∞·ªùi d√πng
                </a>
                <a href="store-management.html" class="nav-item">
                    üè™ Qu·∫£n l√Ω c·ª≠a h√†ng
                </a>
                <a href="display-management.html" class="nav-item">
                    üñ•Ô∏è Qu·∫£n l√Ω Display
                </a>
            </div>
            <div class="nav-mobile-toggle" id="navMobileToggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </nav>

        <!-- Page Header -->
        <div class="page-header">
            <div class="page-header-content">
                <h1>üë• Qu·∫£n l√Ω ng∆∞·ªùi d√πng</h1>
                <p>Qu·∫£n l√Ω t√†i kho·∫£n ng∆∞·ªùi d√πng, ph√¢n quy·ªÅn v√† import/export d·ªØ li·ªáu</p>
            </div>
        </div>

        <!-- Statistics -->
        <div class="stats-container" id="userStatsContainer">
            <!-- Stats will be loaded here -->
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button id="addUserBtn" class="btn btn-primary">
                ‚ûï Th√™m ng∆∞·ªùi d√πng
            </button>
            <button id="importUsersBtn" class="btn btn-secondary">
                üì§ Import CSV
            </button>
            <button id="exportUsersBtn" class="btn btn-green">
                üì• Export CSV
            </button>
        </div>

        <!-- Filters -->
        <div class="filters">
            <div class="filter-group">
                <label>Vai tr√≤:</label>
                <select id="roleFilter">
                    <option value="">T·∫•t c·∫£ vai tr√≤</option>
                    <option value="admin">Admin</option>
                    <option value="user">User</option>
                    <option value="PRT">PRT</option>
                    <option value="TDS">TDS</option>
                    <option value="TDL">TDL</option>
                </select>
            </div>
            <div class="filter-group">
                <label>Tr·∫°ng th√°i:</label>
                <select id="statusFilter">
                    <option value="">T·∫•t c·∫£</option>
                    <option value="active">Ho·∫°t ƒë·ªông</option>
                    <option value="inactive">ƒê√£ kh√≥a</option>
                </select>
            </div>
            <div class="filter-group">
                <label>Leader:</label>
                <select id="leaderFilter">
                    <option value="">T·∫•t c·∫£ Leader</option>
                </select>
            </div>
            <div class="filter-group">
                <label>T√¨m ki·∫øm:</label>
                <input type="text" id="searchInput" placeholder="T√™n, ID, email...">
            </div>
            <div class="filter-group">
                <label>&nbsp;</label>
                <button id="clearFiltersBtn" class="btn btn-secondary">X√≥a b·ªô l·ªçc</button>
            </div>
        </div>

        <!-- Bulk Actions -->
        <div class="bulk-actions">
            <button id="selectAllUsersBtn" class="btn btn-secondary" type="button">
                ‚òëÔ∏è Ch·ªçn t·∫•t c·∫£
            </button>
            <button id="bulkActivateBtn" class="btn btn-green" disabled>
                ‚úÖ K√≠ch ho·∫°t c√°c t√†i kho·∫£n ƒë√£ ch·ªçn
            </button>
            <button id="bulkDeactivateBtn" class="btn btn-orange" disabled>
                ‚ùå Kh√≥a c√°c t√†i kho·∫£n ƒë√£ ch·ªçn
            </button>
            <button id="bulkDeleteUsersBtn" class="btn btn-danger" disabled>
                üóëÔ∏è X√≥a c√°c t√†i kho·∫£n ƒë√£ ch·ªçn
            </button>
        </div>

        <!-- Users Table -->
        <div class="users-container" id="usersContainer">
            <!-- Users will be loaded here -->
        </div>

        <!-- Pagination -->
        <div class="pagination-container" id="usersPaginationContainer">
            <!-- Pagination will be loaded here -->
        </div>

        <!-- Loading overlay -->
        <div id="loadingOverlay" class="loading-overlay">
            <div class="loading-spinner"></div>
            <p>ƒêang t·∫£i d·ªØ li·ªáu...</p>
        </div>

        <!-- Add/Edit User Modal -->
        <div id="userModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modalTitle">Th√™m ng∆∞·ªùi d√πng m·ªõi</h3>
                    <button id="closeModalBtn" class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="userForm">
                        <input type="hidden" id="userId" name="userId">
                        
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="userid">User ID <span class="required">*</span></label>
                                <input type="text" id="userid" name="userid" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="username">H·ªç v√† t√™n <span class="required">*</span></label>
                                <input type="text" id="username" name="username" required>
                            </div>
                        </div>
                        
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="loginid">Login ID <span class="required">*</span></label>
                                <input type="text" id="loginid" name="loginid" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="password">M·∫≠t kh·∫©u <span class="required">*</span></label>
                                <input type="password" id="password" name="password" required>
                                <small>√çt nh·∫•t 6 k√Ω t·ª±</small>
                            </div>
                        </div>
                        
                        <div class="form-grid-three">
                            <div class="form-group">
                                <label for="role">Vai tr√≤ <span class="required">*</span></label>
                                <select id="role" name="role" required>
                                    <option value="">Ch·ªçn vai tr√≤</option>
                                    <option value="admin">Admin</option>
                                    <option value="user">User</option>
                                    <option value="PRT">PRT</option>
                                    <option value="TDS">TDS</option>
                                    <option value="TDL">TDL</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="leader">Leader</label>
                                <select id="leader" name="leader">
                                    <option value="">Ch·ªçn Leader</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="isActive" name="isActive" checked>
                                    T√†i kho·∫£n ho·∫°t ƒë·ªông
                                </label>
                            </div>
                        </div>
                        
                        <div class="form-group form-grid-full">
                            <label for="assignedStores">C·ª≠a h√†ng ƒë∆∞·ª£c ph√¢n quy·ªÅn</label>
                            
                            <!-- Store Assignment Chips Display -->
                            <div id="assignedStoreChips" class="store-chips-container">
                                <!-- Assigned stores will show as chips here -->
                            </div>
                            
                            <!-- Dual List Box Interface -->
                            <div id="storeTransferContainer" class="store-transfer-container">
                                
                                <!-- Search and Filters Row -->
                                <div class="transfer-controls">
                                    <div class="search-filters">
                                        <input type="text" id="storeSearchInput" placeholder="üîç T√¨m ki·∫øm theo t√™n, m√£..." class="search-input">
                                        <select id="regionFilterSelect" class="filter-select">
                                            <option value="">üåç T·∫•t c·∫£ v√πng</option>
                                        </select>
                                        <select id="statusFilterSelect" class="filter-select">
                                            <option value="">üìä T·∫•t c·∫£ tr·∫°ng th√°i</option>
                                            <option value="active">üü¢ Ho·∫°t ƒë·ªông</option>
                                            <option value="inactive">üî¥ T·∫°m d·ª´ng</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- Dual List Interface -->
                                <div class="dual-list-container">
                                    
                                    <!-- Available Stores (Left) -->
                                    <div class="list-panel">
                                        <div class="list-header">
                                            <h4>üìã C·ª≠a h√†ng kh·∫£ d·ª•ng</h4>
                                            <div class="list-stats">
                                                <span id="availableCount">0</span> c·ª≠a h√†ng
                                            </div>
                                            <div class="bulk-actions">
                                                <button type="button" id="selectAllVisibleBtn" class="bulk-btn">Ch·ªçn t·∫•t c·∫£</button>
                                                <button type="button" id="selectByRegionBtn" class="bulk-btn">Ch·ªçn theo v√πng</button>
                                            </div>
                                        </div>
                                        <div class="list-body" id="availableStoresList">
                                            <div class="loading-placeholder">ƒêang t·∫£i...</div>
                                        </div>
                                    </div>
                                    
                                    <!-- Transfer Buttons -->
                                    <div class="transfer-buttons">
                                        <button type="button" id="assignSelectedBtn" class="transfer-btn assign-btn" title="Ph√¢n quy·ªÅn c√°c c·ª≠a h√†ng ƒë√£ ch·ªçn">
                                            <span>‚û°</span>
                                        </button>
                                        <button type="button" id="assignAllBtn" class="transfer-btn assign-all-btn" title="Ph√¢n quy·ªÅn t·∫•t c·∫£">
                                            <span>‚è©</span>
                                        </button>
                                        <button type="button" id="removeSelectedBtn" class="transfer-btn remove-btn" title="B·ªè ph√¢n quy·ªÅn c√°c c·ª≠a h√†ng ƒë√£ ch·ªçn">
                                            <span>‚¨Ö</span>
                                        </button>
                                        <button type="button" id="removeAllBtn" class="transfer-btn remove-all-btn" title="B·ªè ph√¢n quy·ªÅn t·∫•t c·∫£">
                                            <span>‚è™</span>
                                        </button>
                                    </div>
                                    
                                    <!-- Assigned Stores (Right) -->
                                    <div class="list-panel">
                                        <div class="list-header">
                                            <h4>‚úÖ C·ª≠a h√†ng ƒë√£ ph√¢n quy·ªÅn</h4>
                                            <div class="list-stats">
                                                <span id="assignedCount">0</span> c·ª≠a h√†ng
                                            </div>
                                            <div class="bulk-actions">
                                                <button type="button" id="selectAllAssignedBtn" class="bulk-btn">Ch·ªçn t·∫•t c·∫£</button>
                                                <button type="button" id="clearAllAssignedBtn" class="bulk-btn danger">X√≥a t·∫•t c·∫£</button>
                                            </div>
                                        </div>
                                        <div class="list-body" id="assignedStoresList">
                                            <div class="empty-placeholder">Ch∆∞a c√≥ c·ª≠a h√†ng n√†o ƒë∆∞·ª£c ph√¢n quy·ªÅn</div>
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                        </div>
                        
                    </form>
                </div>
                <div class="modal-footer">
                    <button id="saveUserBtn" class="btn btn-primary">L∆∞u</button>
                    <button id="cancelUserBtn" class="btn btn-secondary">H·ªßy</button>
                </div>
            </div>
        </div>

        <!-- Import CSV Modal -->
        <div id="importModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Import ng∆∞·ªùi d√πng t·ª´ CSV</h3>
                    <button id="closeImportModalBtn" class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="import-info">
                        <h4>ƒê·ªãnh d·∫°ng file CSV:</h4>
                        <p>File CSV c·∫ßn c√≥ c√°c c·ªôt sau (h√†ng ƒë·∫ßu ti√™n l√† header):</p>
                        <code>userid,username,loginid,role,leader,password,isActive</code>
                        
                        <h4>V√≠ d·ª•:</h4>
                        <pre>userid,username,loginid,role,leader,password,isActive
ELUX00001,Nguyen Van A,nvana@company.com,PRT,Tran Van B,123456,true
ELUX00002,Le Thi C,lthic@company.com,TDS,Tran Van B,123456,true</pre>
                        
                        <div class="import-notes">
                            <strong>L∆∞u √Ω:</strong>
                            <ul>
                                <li>File t·ªëi ƒëa 5MB</li>
                                <li>Ch·ªâ h·ªó tr·ª£ ƒë·ªãnh d·∫°ng .csv, .xlsx, .xls</li>
                                <li>N·∫øu userid ƒë√£ t·ªìn t·∫°i, th√¥ng tin s·∫Ω ƒë∆∞·ª£c c·∫≠p nh·∫≠t</li>
                                <li>isActive: true/false ho·∫∑c 1/0</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="file-upload-area">
                        <input type="file" id="csvFileInput" accept=".csv,.xlsx,.xls" style="display: none;">
                        <div class="file-drop-zone" id="fileDropZone">
                            <div class="file-drop-content">
                                <div class="file-drop-icon">üìÑ</div>
                                <div class="file-drop-text">
                                    <p><strong>K√©o th·∫£ file CSV v√†o ƒë√¢y</strong></p>
                                    <p>ho·∫∑c <button type="button" id="selectFileBtn" class="btn-link">ch·ªçn file</button></p>
                                </div>
                            </div>
                        </div>
                        <div id="selectedFileInfo" class="selected-file-info" style="display: none;">
                            <span id="selectedFileName"></span>
                            <button type="button" id="removeFileBtn" class="btn-remove">√ó</button>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="importBtn" class="btn btn-primary" disabled>Import</button>
                    <button id="cancelImportBtn" class="btn btn-secondary">H·ªßy</button>
                </div>
            </div>
        </div>

        <!-- Confirm delete dialog -->
        <div id="confirmDeleteDialog" class="confirm-dialog">
            <div class="confirm-content">
                <h3>X√°c nh·∫≠n x√≥a</h3>
                <p id="deleteConfirmText">B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a ng∆∞·ªùi d√πng n√†y?</p>
                <div class="confirm-buttons">
                    <button id="btnConfirmDelete" class="btn-confirm">X√≥a</button>
                    <button id="btnCancelDelete" class="btn-cancel">H·ªßy</button>
                </div>
            </div>
        </div>
    </div>

    <script src="pagination-component.js"></script>
    <script src="user-management.js"></script>
</body>
</html>